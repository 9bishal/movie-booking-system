<div class="row mb-5">
    <div class="col-12 d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-bms-blue">
            <i class="fas fa-play-circle me-2"></i>Now Showing
        </h2>
        <div class="nav-tabs-bms">
            <a class="nav-link active">All</a>
            <a class="nav-link">2D</a>
            <a class="nav-link">3D</a>
            <a class="nav-link">IMAX</a>
        </div>
    </div>
    
    {% for movie in now_showing %}
    <div class="col-xl-3 col-lg-4 col-md-6 mb-4">
        <div class="movie-card hover-lift position-relative cursor-pointer" onclick="window.location.href='{% url 'movie_detail' movie.slug %}';">
            <div class="position-absolute top-0 end-0 m-2 d-flex flex-column align-items-center" style="z-index: 10;">
                <!-- Wishlist (Watch Later) -->
                <button class="btn btn-icon rounded-circle bg-white shadow-sm border-0 mb-1 {% if movie.id in user_wishlist %}active{% endif %}" 
                        onclick="event.stopPropagation(); toggleWishlist(this, '{{ movie.id }}')" 
                        title="Watch Later"
                        style="width: 35px; height: 35px;">
                    <i class="{% if movie.id in user_wishlist %}fas text-danger{% else %}far text-muted{% endif %} fa-heart"></i>
                </button>
            </div>

            {% if movie.poster %}
            <img src="{{ movie.poster.url }}" alt="{{ movie.title }}" class="movie-card-img">
            {% else %}
            <div class="movie-card-img bg-dark d-flex align-items-center justify-content-center">
                <i class="fas fa-film fa-4x text-white"></i>
            </div>
            {% endif %}
            <div class="movie-card-body">
                <h5 class="movie-card-title text-truncate" title="{{ movie.title }}">{{ movie.title }}</h5>
                <div class="d-flex align-items-center mb-3">
                    <span class="badge bg-primary me-2">{{ movie.certificate }}</span>
                    {% if movie.language %}
                    <span class="badge bg-info me-2">{{ movie.language.name }}</span>
                    {% endif %}
                </div>
                <!-- Added line-clamp for description -->
                <p class="text-muted small mb-3" style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                    {{ movie.description }}
                </p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-star text-warning me-1"></i>
                        <span class="fw-bold text-dark">{% if movie.rating %}{{ movie.rating|floatformat:1 }}{% else %}7.5{% endif %}</span>
                        <span class="text-muted small ms-1">/10</span>
                        <span class="text-muted small ms-2">â€¢ <span class="interest-count-{{ movie.id }}">{{ movie.interest_count }}</span> Count Interested</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="booking-card text-center py-4">
            <p class="text-muted mb-0">No movies showing currently</p>
        </div>
    </div>
    {% endfor %}
</div>
